<UserControl x:Class="HealthLogger.Views.HistorialClinicoView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:materialDesign="clr-namespace:MaterialDesignThemes.Wpf;assembly=MaterialDesignThemes.Wpf"
             mc:Ignorable="d"
             FontSize="16"
             FontFamily="Roboto"
             d:DesignHeight="1200" d:DesignWidth="900">

    <Grid Background="#f0f0f0">
        <Border Background="White" 
                Margin="20" 
                Padding="30" 
                CornerRadius="6" 
                Effect="{DynamicResource MaterialDesignElevation3}">

            <Grid>
                <Grid.RowDefinitions>
                    <!-- Fila fija: barra superior -->
                    <RowDefinition Height="Auto"/>
                    <!-- Fila desplazable: contenido -->
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- 🔹 Encabezado fijo -->
                <DockPanel Grid.Row="0" Margin="0 0 0 20">
                    <Button Content="⟵ Volver"
                        Click="Volver_Click"
                        Style="{StaticResource MaterialDesignOutlinedButton}"
                        DockPanel.Dock="Left" Width="100"/>
                    <StackPanel Orientation="Horizontal" DockPanel.Dock="Right" HorizontalAlignment="Right">
                        <Button Content="💾 Guardar Cambios"
                            Click="Guardar_Click"
                            Style="{StaticResource MaterialDesignRaisedButton}"
                            Width="170"/>
                        <Button Content="🖨 Imprimir PDF"
                            Click="GenerarPdf_Click"
                            Style="{StaticResource MaterialDesignOutlinedButton}"
                                Margin="5 0 0 0"
                            Width="150"/>
                    </StackPanel>
                </DockPanel>

                <!-- 🔹 Contenido desplazable -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="Historial Clínico" HorizontalAlignment="Center"
                            FontWeight="Bold" FontSize="32" Margin="0 0 0 10"/>

                        <!-- Datos personales -->
                        <Grid Margin="0 0 0 20">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*"/>
                                <ColumnDefinition Width="1*"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" Margin="10">
                                <TextBlock Text="Datos de Filiación" 
                                           FontWeight="Bold" FontSize="20" Margin="0 0 0 10"/>

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <!-- 50% -->
                                        <ColumnDefinition Width="*" />
                                        <!-- 50% -->
                                    </Grid.ColumnDefinitions>

                                    <TextBox materialDesign:HintAssist.Hint="Nombres" TextChanged="AnyFieldChanged"
                                             Text="{Binding Paciente.Nombres, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                             Margin="0 0 5 5" Grid.Column="0"/>
                                    <TextBox materialDesign:HintAssist.Hint="Apellidos" TextChanged="AnyFieldChanged"
                                             Text="{Binding Paciente.Apellidos, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                             Margin="5 0 0 5" Grid.Column="1"/>
                                </Grid>
                                <TextBox materialDesign:HintAssist.Hint="C.I." TextChanged="AnyFieldChanged"
                                         Text="{Binding Paciente.CI, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         Margin="0 5"/>
                                <TextBox materialDesign:HintAssist.Hint="Profesión" TextChanged="AnyFieldChanged"
                                         Text="{Binding Paciente.Profesion, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         Margin="0 5"/>
                                <TextBox materialDesign:HintAssist.Hint="Dirección" TextChanged="AnyFieldChanged"
                                         Text="{Binding Paciente.Direccion, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         Margin="0 5"/>

                                <DatePicker SelectedDate="{Binding Paciente.FechaNacimiento, UpdateSourceTrigger=PropertyChanged}"
                                            Margin="0 5" materialDesign:HintAssist.Hint="Fecha de Nacimiento"/>

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />

                                    </Grid.ColumnDefinitions>
                                    <TextBlock FontWeight="Bold" Text="Edad:" HorizontalAlignment="Right"
                                         Margin="0 10" Grid.Column="4"/>
                                    <TextBox materialDesign:HintAssist.Hint="Edad"
                                         Text="{Binding Paciente.Edad, Mode=OneWay}"
                                         IsReadOnly="True" Grid.Column="5" HorizontalAlignment="Right"
                                         Margin="5 5"/>
                                </Grid>
                            </StackPanel>

                            <StackPanel Grid.Column="1" Margin="10">
                                <TextBlock Text="" 
                                           FontWeight="Bold" FontSize="16" Margin="0 0 0 10"/>
                                <TextBox materialDesign:HintAssist.Hint="Teléfono" TextChanged="AnyFieldChanged"
                                         Text="{Binding Paciente.Telefono, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         Margin="0 5"/>
                                <TextBox materialDesign:HintAssist.Hint="Nombre de Contacto de Emergencia" TextChanged="AnyFieldChanged"
                                         Text="{Binding Paciente.ContactoEmergencia, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         Margin="0 5"/>
                                <TextBox materialDesign:HintAssist.Hint="Teléfono de Contacto de Emergencia" TextChanged="AnyFieldChanged"
                                         Text="{Binding Paciente.TelefonoEmergencia, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         Margin="0 5"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <!-- 50% -->
                                        <ColumnDefinition Width="*" />
                                        <!-- 50% -->
                                    </Grid.ColumnDefinitions>
                                    <ComboBox materialDesign:HintAssist.Hint="Sexo"
                                          ItemsSource="{Binding DataContext.OpcionesSexo}"
                                          DisplayMemberPath="Texto"
                                          SelectedValuePath="Valor"
                                          SelectedValue="{Binding Paciente.Sexo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                          SelectionChanged="AnyFieldChanged"
                                          Margin="0 5 5 5"/>
                                    <ComboBox materialDesign:HintAssist.Hint="Estado Civil" Grid.Column="1"
                                          ItemsSource="{Binding DataContext.OpcionesEstadoCivil}"
                                          DisplayMemberPath="Texto"
                                          SelectedValuePath="Valor"
                                          SelectedValue="{Binding Paciente.EstadoCivil, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                          SelectionChanged="AnyFieldChanged"
                                          Margin="5 5 0 5"/>
                                </Grid>
                            </StackPanel>
                        </Grid>

                        <!-- Cuerpo clínico tipo documento -->
                        <StackPanel>
                            <TextBlock Text="Motivo de Consulta" FontWeight="Bold" FontSize="16" Margin="0 10 0 5"/>
                            <TextBox x:Name="TxtMotivoConsulta"
                                     AcceptsReturn="True"
                                     MinHeight="80"
                                     TextWrapping="Wrap"
                                     TextChanged="AutoGrowTextBox"
                                     Text="{Binding Paciente.MotivoConsulta, UpdateSourceTrigger=PropertyChanged}"
                                     Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
                            <TextBlock Text="Enfermedad Actual" FontWeight="Bold" FontSize="16" Margin="0 10 0 5"/>
                            <TextBox x:Name="TxtEnfermedadActual"
                                     AcceptsReturn="True"
                                     MinHeight="80"
                                     TextWrapping="Wrap"
                                     TextChanged="AutoGrowTextBox"
                                     Text="{Binding Paciente.EnfermedadActual, UpdateSourceTrigger=PropertyChanged}"
                                     Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
                            <TextBlock Text="Antecedentes - Alergias" FontWeight="Bold" FontSize="16" Margin="0 10 0 5"/>
                            <TextBox x:Name="TxtAntecedentes"
                                     AcceptsReturn="True"
                                     MinHeight="80"
                                     TextWrapping="Wrap"
                                     TextChanged="AutoGrowTextBox"
                                     Text="{Binding Paciente.Antecedentes, UpdateSourceTrigger=PropertyChanged}"
                                     Style="{StaticResource MaterialDesignOutlinedTextBox}"/>

                            <TextBlock Text="Examen Neurológico" FontWeight="Bold" FontSize="16" Margin="0 15 0 5"/>
                            <TextBox x:Name="TxtExamenNeurologico"
                                     AcceptsReturn="True"
                                     MinHeight="80"
                                     TextWrapping="Wrap"
                                     TextChanged="AutoGrowTextBox"
                                     Text="{Binding Paciente.ExamenNeurologico, UpdateSourceTrigger=PropertyChanged}"
                                     Style="{StaticResource MaterialDesignOutlinedTextBox}"/>

                            <TextBlock Text="Impresión Diagnóstica" FontWeight="Bold" FontSize="16" Margin="0 15 0 5"/>
                            <TextBox x:Name="TxtImpresionDiagnostica"
                                     AcceptsReturn="True"
                                     MinHeight="80"
                                     TextWrapping="Wrap"
                                     TextChanged="AutoGrowTextBox"
                                     Text="{Binding Paciente.ImpresionDiagnostica, UpdateSourceTrigger=PropertyChanged}"
                                     Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
                            <TextBlock Text="Conducta" FontWeight="Bold" FontSize="16" Margin="0 15 0 5"/>
                            <TextBox x:Name="TxtConducta"
                                     AcceptsReturn="True"
                                     MinHeight="80"
                                     TextWrapping="Wrap"
                                     TextChanged="AutoGrowTextBox"
                                     Text="{Binding Paciente.Conducta, UpdateSourceTrigger=PropertyChanged}"
                                     Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
                            <TextBlock Text="Evolución" FontWeight="Bold" FontSize="16" Margin="0 15 0 5"/>
                            <TextBox x:Name="TxtEvolucion"
                                     AcceptsReturn="True"
                                     MinHeight="80"
                                     TextWrapping="Wrap"
                                     TextChanged="AutoGrowTextBox"
                                     Text="{Binding Paciente.Evolucion, UpdateSourceTrigger=PropertyChanged}"
                                     Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
                        </StackPanel>

                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </Border>
    </Grid>
</UserControl>